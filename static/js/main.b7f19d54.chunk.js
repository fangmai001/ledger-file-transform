(this["webpackJsonpledger-file-transform"]=this["webpackJsonpledger-file-transform"]||[]).push([[0],{277:function(e,t,n){},278:function(e,t,n){},326:function(e,t){},336:function(e,t,n){},350:function(e,t,n){},352:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),s=n.n(c),i=(n(277),n(278),n(256)),o=n(257),l=n(270),j=n(267),u=n(358),d=n(362),h=n(122),b=n(268),f=n(157),O=n(107),x=n(52),g=n(361),m=n(359),p=n(88),v=n(363),w=n(360),y=n(364),A=n(365),C=n(366),D=n(271),F=n(105),N=n.n(F),I=n(121),S=n.n(I),_=n(258),k=n.n(_);N.a.locale("zh-tw");var E=function(e,t,n){var a=new S.a(e,t).map((function(e){return e.set("\u91d1\u984d",parseFloat(e.get("\u91d1\u984d")))})),r=new S.a([["","","","\u65e9\u9910",a.where((function(e){return"\u65e9\u9910"===e.get("\u985e\u5225")})).stat.sum("\u91d1\u984d"),""],["","","","\u5348\u9910",a.where((function(e){return"\u5348\u9910"===e.get("\u985e\u5225")})).stat.sum("\u91d1\u984d"),""],["","","","\u665a\u9910",a.where((function(e){return"\u665a\u9910"===e.get("\u985e\u5225")})).stat.sum("\u91d1\u984d"),""]],t),c=a.where((function(e){return"\u751f\u6d3b\u8cbb"===e.get("\u5e33\u6236")&&"\u65e9\u9910"!==e.get("\u985e\u5225")&&"\u5348\u9910"!==e.get("\u985e\u5225")&&"\u665a\u9910"!==e.get("\u985e\u5225")})),s=a.where((function(e){return"\u975e\u751f\u6d3b\u8cbb"===e.get("\u5e33\u6236")}));return new k.a({fileName:"ledger_".concat(n),datas:[{sheetData:r.toArray(),sheetHeader:t,sheetName:"\u9910\u98f2\u8cbb"},{sheetData:c.toArray(),sheetHeader:t,sheetName:"\u751f\u6d3b\u8cbb"},{sheetData:s.toArray(),sheetHeader:t,sheetName:"\u975e\u751f\u6d3b\u8cbb"},{sheetData:a.toArray(),sheetHeader:t,sheetName:"\u5168\u90e8"}]})},H=(n(336),n(11));N.a.locale("zh-tw");var L=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),s=Object(f.a)(c,2),i=s[0],o=s[1],l=Object(a.useState)("life"),j=Object(f.a)(l,2),u=j[0],d=j[1],F=function(e){var t=e.target.result;I(t)},I=function(e){var t=e.split(" \r\n");console.log("textStr",e.split(" \r\n"));var n=-1;-1!==(n=t.indexOf("-- \u652f\u51fa --"))&&t.splice(n,1),-1!==(n=t.indexOf("\r\n\r\n-- \u6536\u5165 --"))&&t.splice(n);var a=t.map((function(e){return e.split(", ")}));_(a)},_=function(e){var t=function(e){var t=e[0],n=e.slice(1),a=new S.a(n,t);console.log("df",a);var r=a.count(),c=[],s=[{date:N()(a.getRow(0).get("\u65e5\u671f")),source:[a.getRow(0).toArray()]}];return a.sortBy("\u65e5\u671f").map((function(e,n){var a,i,o=N()(e.get("\u65e5\u671f")),l=s.findIndex((function(e){return e.date.month()===o.month()}));if(-1===l||n+1===r){var j=s[s.length-1],u=j.date.startOf("month").format("YYYY-MM");c.push({toExcel:E(j.source,t,u),representedAt:u,total:(a=j.source,i=t,new S.a(a,i).stat.sum("\u91d1\u984d"))}),s.push({date:o,source:[e.toArray()]})}else s[l].source.push(e.toArray())})),c.reverse()}(e);o(Object(b.a)(t))},k={xs:24,sm:12};return Object(H.jsx)("div",{children:Object(H.jsxs)(O.a,{gutter:[16,16],children:[Object(H.jsx)(x.a,Object(h.a)(Object(h.a)({},k),{},{children:Object(H.jsxs)(g.a,{title:"\u4e0a\u50b3\u6a94\u6848",children:[Object(H.jsx)(m.a,{customRequest:function(){},fileList:n,onChange:function(e){var t=e.fileList.map((function(e){var t=new FileReader;return t.onload=F,t.readAsText(e.originFileObj),e.status="success",e}));r(t)},children:Object(H.jsx)(p.a,{icon:Object(H.jsx)(A.a,{}),children:"\u6a94\u6848\u4e0a\u50b3"})}),Object(H.jsx)(p.a,{onClick:function(){o([]),r([])},children:"\u6e05\u9664\u8f49\u63db\u6a94\u6848"}),Object(H.jsx)("a",{href:"/ledger-file-transform/Ahorro_Export_Data_20210601.csv",download:"Ahorro_Export_Data_20210601.csv",children:Object(H.jsx)(p.a,{style:{margin:"10px"},children:"Download example"})}),Object(H.jsx)("br",{}),Object(H.jsxs)(v.a.Group,{onChange:function(e){o([]),r([]),d(e.target.value)},value:u,children:[Object(H.jsx)(v.a,{value:"default",disabled:!0,children:"\u9810\u8a2d"}),Object(H.jsx)(v.a,{value:"life",children:"\u5340\u5206\u751f\u6d3b\u8cbb\u3001\u9910\u98f2\u8cbb"})]})]})})),Object(H.jsx)(x.a,Object(h.a)(Object(h.a)({},k),{},{children:Object(H.jsx)(g.a,{title:"\u4e0b\u8f09\u8f49\u63db\u6a94\u6848",children:Object(H.jsx)(w.b,{itemLayout:"horizontal",dataSource:i,renderItem:function(e){return Object(H.jsx)(w.b.Item,{children:Object(H.jsx)(w.b.Item.Meta,{avatar:Object(H.jsx)(y.a,{icon:Object(H.jsx)(C.a,{})}),title:"\u8a18\u5e33\u7d00\u9304",description:Object(H.jsxs)("div",{children:[Object(H.jsx)(p.a,{icon:Object(H.jsx)(D.a,{}),onClick:function(){e.toExcel.saveExcel()},children:"\u6a94\u6848\u4e0b\u8f09"})," ",Object(H.jsxs)("span",{children:["\u65e5\u671f: ",e.representedAt]})," ",Object(H.jsxs)("span",{children:["\u7e3d\u984d: ",e.total,"$"]})]})})})}})})}))]})})},z=(n(349),n(350),function(e){Object(l.a)(n,e);var t=Object(j.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(H.jsxs)(u.a,{children:[Object(H.jsx)(u.a.Header,{style:{position:"fixed",zIndex:1,width:"100%"},children:Object(H.jsx)("div",{className:"logo"})}),Object(H.jsxs)(u.a.Content,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:[Object(H.jsx)(d.a,{style:{margin:"16px 0"}}),Object(H.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:800},children:Object(H.jsx)(L,{})})]}),Object(H.jsx)(u.a.Footer,{style:{textAlign:"center"},children:"\xa92021"})]})}}]),n}(a.Component));var M=function(){return Object(H.jsx)(z,{})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,367)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(H.jsx)(r.a.StrictMode,{children:Object(H.jsx)(M,{})}),document.getElementById("root")),R()}},[[352,1,2]]]);
//# sourceMappingURL=main.b7f19d54.chunk.js.map